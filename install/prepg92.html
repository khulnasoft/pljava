<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.11.1 from src/site/markdown/install/prepg92.md at 2024-04-03

 | Rendered using Apache Maven Default Skin
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="generator" content="Apache Maven Doxia Site Renderer 1.11.1" />
    <title>PostgreSQL PL/Java &#x2013; Installation on PostgreSQL releases earlier than 9.2</title>
    <link rel="stylesheet" href="../css/maven-base.css" />
    <link rel="stylesheet" href="../css/maven-theme.css" />
    <link rel="stylesheet" href="../css/site.css" />
    <link rel="stylesheet" href="../css/print.css" media="print" />
  </head>
  <body class="composite">
    <div id="banner">
<a href="https://tada.github.io/pljava/" id="bannerLeft" title="PL/Java logo combining the PostgreSQL elephant and a Java bean"><img src="../images/pljava_logo.jpg"  alt="PL/Java logo combining the PostgreSQL elephant and a Java bean"/></a>      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
      <div class="xleft">
        <span id="publishDate">Last Published: 2024-04-03</span>
           | <span id="projectVersion">Version: 1.6.7</span>
      </div>
      <div class="xright"><a href="https://github.com/tada/pljava/wiki/" class="externalLink" title="Wiki">Wiki</a> |
<a href="https://github.com/tada/pljava/issues" class="externalLink" title="Issues">Issues</a> |
<a href="https://www.postgresql.org/list/pljava-dev/" class="externalLink" title="Mailing list">Mailing list</a> |
<a href="https://github.com/tada/pljava/tree/master/" class="externalLink" title="Code">Code</a>      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
       <h5>Usage</h5>
    <ul>
     <li class="none"><a href="../build/build.html" title="Building PL/Java">Building PL/Java</a></li>
     <li class="none"><a href="../install/install.html" title="Installing into PostgreSQL">Installing into PostgreSQL</a></li>
     <li class="none"><a href="../install/upgrade.html" title="Upgrading">Upgrading</a></li>
     <li class="none"><a href="../build/package.html" title="Packaging PL/Java">Packaging PL/Java</a></li>
     <li class="none"><a href="../use/use.html" title="User guide">User guide</a></li>
     <li class="none"><a href="../develop/develop.html" title="Developer notes">Developer notes</a></li>
    </ul>
       <h5>Release Information</h5>
    <ul>
     <li class="none"><a href="../releasenotes.html" title="Release notes">Release notes</a></li>
    </ul>
       <h5>Modules</h5>
    <ul>
     <li class="none"><a href="../pljava-api/index.html" title="PL/Java API">PL/Java API</a></li>
     <li class="none"><a href="../pljava/index.html" title="PL/Java backend Java code">PL/Java backend Java code</a></li>
     <li class="none"><a href="../pljava-so/index.html" title="PL/Java backend native code">PL/Java backend native code</a></li>
     <li class="none"><a href="../pljava-ant/index.html" title="PL/Java Ant tasks">PL/Java Ant tasks</a></li>
     <li class="none"><a href="../pljava-examples/index.html" title="PL/Java examples">PL/Java examples</a></li>
     <li class="none"><a href="../pljava-packaging/index.html" title="PL/Java packaging">PL/Java packaging</a></li>
     <li class="none"><a href="../pljava-pgxs/index.html" title="PL/Java PGXS">PL/Java PGXS</a></li>
    </ul>
       <h5>Project Documentation</h5>
    <ul>
     <li class="collapsed"><a href="../project-info.html" title="Project Information">Project Information</a></li>
    </ul>
      <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="poweredBy" alt="Built by Maven" src="../images/logos/maven-feather.png" />
      </a>
      </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
<h1>Installation on PostgreSQL releases earlier than 9.2</h1>
<p>In PostgreSQL releases 9.2 and later, PL/Java can be installed entirely
without disturbing the <code>postgresql.conf</code> file or reloading/restarting the
server: the configuration variables can be set interactively in a session
until PL/Java loads sucessfully, then saved with a simple
<code>ALTER DATABASE</code> <i>dbname</i> <code>SET</code> <i>var</i> <code>FROM CURRENT</code> for each setting
that had to be changed.</p>
<p>Releases earlier than 9.2 are slightly less convenient. It is still possible
to work out the right settings in an interactive session, but once found,
the settings must be added to <code>postgresql.conf</code> to be persistent, and the
postmaster signalled (with <code>pg_ctl reload</code>) to pick up the new settings.</p>
<p>Releases before 9.2 also require setting <code>custom_variable_classes</code> in
<code>postgresql.conf</code> to include the prefix <code>pljava</code>, and that assignment must
be earlier in the file than any settings of <code>pljava.*</code> variables.</p><section>
<h2><a name="Trying_settings_interactively"></a>Trying settings interactively</h2>
<p>It is still possible to do an exploratory session to find the variable settings
that work before touching <code>postgresql.conf</code> at all, but
the details are slightly different.</p>
<p>In later PostgreSQL versions, you would typically use some <code>SET</code> commands
followed by a <code>LOAD</code> (followed, perhaps, by more <code>SET</code> commands unless you
always get things right on the first try).</p>
<p>Before release 9.2, however, the order has to be <code>LOAD</code> first, which typically
will lead to an incompletely-started warning because the configuration settings
have not been made yet. <i>Then</i>, because the module has been loaded,
<code>pljava.*</code> variables will be recognized and can be set and changed until
PL/Java successfully loads, just as in the newer versions of PostgreSQL.</p>
<p>Once working settings are found, edit <code>postgresql.conf</code>, make sure that
<code>custom_variable_classes</code> includes <code>pljava</code>, copy in the variable settings
that worked, and use <code>pg_ctl reload</code> to make the new settings effective.</p></section><section>
<h2><a name="But_what_if_I_want_the_load_to_fail_and_it_doesn.27t.3F"></a>But what if I want the load to fail and it doesn't?</h2>
<p>The procedure above relies on the way loading stops when the settings are not
right, giving you a chance to adjust them interactively. That turns out to be
a problem if there are previously-saved settings, or the original defaults,
that happen to <i>work</i> even if they are not the settings you want. In that case,
the <code>LOAD</code> command starts PL/Java right up, leaving you no chance in the
interactive session to change anything.</p>
<p>To escape that behavior, there is one more very simple configuration variable,
<code>pljava.enable</code>. If it is <code>off</code>, <code>LOAD</code>ing PL/Java will always stop early and
allow you to set other variables before setting <code>pljava.enable</code> to <code>on</code>.</p>
<p>To answer the hen-and-egg question of how to set <code>pljava.enable</code> to <code>off</code>
before loading the module, it <i>defaults</i> to <code>off</code> on PostgreSQL releases
earlier than 9.2, so you will always have the chance to test your settings
interactively (and you will always have to set it explicitly <code>on</code> when
you are ready).</p>
<p>If it is already <code>on</code> because of an earlier configuration saved in
<code>postgresql.conf</code>, it will be recognized in your interactive session and you
can set it <code>off</code> as needed.</p>
<p>On later PostgreSQL releases with no such complications, it defaults to <code>on</code>
and can be ignored.</p></section>
      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">
        Copyright &#169;      2003&#x2013;2024<a href="http://tada.se/eng/">Tada AB</a>.
.      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
